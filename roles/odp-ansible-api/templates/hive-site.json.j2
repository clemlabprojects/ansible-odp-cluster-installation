{
	"Clusters": {
		"desired_configs": {
			"type": "hive-site",
			"tag": "{{ range(00000000, 99999999) | random }}",
			"properties": {
				"hive.metastore.warehouse.external.dir": "/warehouse/tablespace/external/hive",
				"hive.hook.proto.base-directory": "{hive_metastore_warehouse_external_dir}/sys.db/query_data/",
				"javax.jdo.option.ConnectionDriverName" : {% if database_type == "mysql" %}"com.mysql.jdbc.Driver"{% elif database_type == "postgresql" %}"org.postgresql.Driver"{% endif %},
	      "javax.jdo.option.ConnectionURL": "jdbc:{{ database_type }}://{{ database_server }}:{{ database_port }}/{{ database_hive }}?createDatabaseIfNotExist=true",
	      "javax.jdo.option.ConnectionUserName": "{{ database_hive_user }}",
	      "javax.jdo.option.ConnectionPassword": "{{ database_hive_user_password }}",
        "ambari.hive.db.schema.name" : "hive",
				{% if cluster_services.ATLAS is defined and cluster_services.ATLAS.SSL is defined and cluster_services.HIVE.SSL %}
				"atlas.rest.address": "https://{{all['ATLAS_SERVER'][0]}}:21443",
				{% elif cluster_services.ATLAS is defined and cluster_services.ATLAS.SSL is not defined %}
				"atlas.rest.address": "http://{{all['ATLAS_SERVER'][0]}}:21000",
				{% else %}
				"atlas.rest.address": "http://localhost:21000",
				{% endif %}
        "atlas.hook.hive.maxThreads" : "1",
        "atlas.hook.hive.minThreads" : "1",
        "datanucleus.autoCreateSchema" : "false",
        "datanucleus.cache.level2.type" : "none",
        "datanucleus.fixedDatastore" : "true",
        "fs.file.impl.disable.cache" : "true",
        "fs.hdfs.impl.disable.cache" : "true",
        "hive.auto.convert.join" : "true",
        "hive.auto.convert.join.noconditionaltask" : "true",
        "hive.auto.convert.join.noconditionaltask.size" : "286331153",
        "hive.auto.convert.sortmerge.join" : "true",
        "hive.auto.convert.sortmerge.join.to.mapjoin" : "false",
        "hive.cbo.enable" : "true",
        "hive.cli.print.header" : "false",
        "hive.cluster.delegation.token.store.class" : "org.apache.hadoop.hive.thrift.ZooKeeperTokenStore",
        "hive.cluster.delegation.token.store.zookeeper.connectString" : "{% for host in zookeeper_quorum %}{{ host }}:2181{% if not loop.last %},{% endif %}{% endfor %}",
        "hive.cluster.delegation.token.store.zookeeper.znode" : "/hive/cluster/delegation",
        "hive.compactor.abortedtxn.threshold" : "1000",
        "hive.compactor.check.interval" : "300L",
        "hive.compactor.delta.num.threshold" : "10",
        "hive.compactor.delta.pct.threshold" : "0.1f",
        "hive.compactor.initiator.on" : "false",
        "hive.compactor.worker.threads" : "0",
        "hive.compactor.worker.timeout" : "86400L",
        "hive.compute.query.using.stats" : "true",
        "hive.conf.restricted.list" : "hive.security.authenticator.manager,hive.security.authorization.manager,hive.users.in.admin.role",
        "hive.convert.join.bucket.mapjoin.tez" : "false",
        "hive.default.fileformat" : "TextFile",
        "hive.default.fileformat.managed" : "TextFile",
        "hive.enforce.bucketing" : "true",
        "hive.enforce.sorting" : "true",
        "hive.enforce.sortmergebucketmapjoin" : "true",
        "hive.exec.compress.intermediate" : "false",
        "hive.exec.compress.output" : "false",
        "hive.exec.dynamic.partition" : "true",
        "hive.exec.dynamic.partition.mode" : "nonstrict",
        "hive.exec.failure.hooks" : "org.apache.hadoop.hive.ql.hooks.ATSHook",
        "hive.exec.max.created.files" : "100000",
        "hive.exec.max.dynamic.partitions" : "5000",
        "hive.exec.max.dynamic.partitions.pernode" : "2000",
        "hive.exec.orc.compression.strategy" : "SPEED",
        "hive.exec.orc.default.compress" : "ZLIB",
        "hive.exec.orc.default.stripe.size" : "67108864",
        "hive.exec.orc.encoding.strategy" : "SPEED",
        "hive.exec.parallel" : "false",
        "hive.exec.parallel.thread.number" : "8",
        "hive.exec.post.hooks" : "org.apache.hadoop.hive.ql.hooks.ATSHook",
        "hive.exec.pre.hooks" : "org.apache.hadoop.hive.ql.hooks.ATSHook",
        "hive.exec.reducers.bytes.per.reducer" : "67108864",
        "hive.exec.reducers.max" : "1009",
        "hive.exec.scratchdir" : "/tmp/hive",
        "hive.exec.submit.local.task.via.child" : "true",
        "hive.exec.submitviachild" : "false",
        "hive.execution.engine" : "tez",
        "hive.fetch.task.aggr" : "false",
        "hive.fetch.task.conversion" : "more",
        "hive.fetch.task.conversion.threshold" : "1073741824",
        "hive.limit.optimize.enable" : "true",
        "hive.limit.pushdown.memory.usage" : "0.04",
        "hive.heapsize" : "1024",
        "hive.map.aggr" : "true",
        "hive.map.aggr.hash.force.flush.memory.threshold" : "0.9",
        "hive.map.aggr.hash.min.reduction" : "0.5",
        "hive.map.aggr.hash.percentmemory" : "0.5",
        "hive.mapjoin.bucket.cache.size" : "10000",
        "hive.mapjoin.optimized.hashtable" : "true",
        "hive.mapred.reduce.tasks.speculative.execution" : "false",
        "hive.merge.mapfiles" : "true",
        "hive.merge.mapredfiles" : "false",
        "hive.merge.orcfile.stripe.level" : "true",
        "hive.merge.rcfile.block.level" : "true",
        "hive.merge.size.per.task" : "256000000",
        "hive.merge.smallfiles.avgsize" : "16000000",
        "hive.merge.tezfiles" : "false",
        "hive.metastore.authorization.storage.checks" : "false",
        "hive.metastore.cache.pinobjtypes" : "Table,Database,Type,FieldSchema,Order",
        "hive.metastore.client.connect.retry.delay" : "5s",
        "hive.metastore.client.socket.timeout" : "1800s",
        "hive.metastore.connect.retries" : "24",
        "hive.metastore.execute.setugi" : "true",
        "hive.metastore.failure.retries" : "24",
        "hive.metastore.kerberos.keytab.file" : "/etc/security/keytabs/hive.service.keytab",
        "hive.metastore.kerberos.principal" : "hive/_HOST@EXAMPLE.COM",
        "hive.metastore.pre.event.listeners" : "org.apache.hadoop.hive.ql.security.authorization.AuthorizationPreEventListener",
        "hive.metastore.sasl.enabled" : "false",
        "hive.metastore.server.max.threads" : "100000",
        "hive.metastore.uris" : "thrift://{{ all['HIVE_METASTORE'][0] }}:9083",
        "hive.metastore.warehouse.dir" : "/apps/hive/warehouse",
        "hive.optimize.bucketmapjoin" : "true",
        "hive.optimize.bucketmapjoin.sortedmerge" : "false",
        "hive.optimize.constant.propagation" : "true",
        "hive.optimize.index.filter" : "true",
        "hive.optimize.metadataonly" : "true",
        "hive.optimize.null.scan" : "true",
        "hive.optimize.reducededuplication" : "true",
        "hive.optimize.reducededuplication.min.reducer" : "4",
        "hive.optimize.sort.dynamic.partition" : "false",
        "hive.orc.compute.splits.num.threads" : "10",
        "hive.orc.splits.include.file.footer" : "false",
        "hive.prewarm.enabled" : "false",
        "hive.prewarm.numcontainers" : "3",
        "hive.security.authenticator.manager" : "org.apache.hadoop.hive.ql.security.ProxyUserAuthenticator",
        "hive.security.authorization.enabled" : "{%if cluster_services.RANGER is defined and cluster_services.RANGER.PLUGIN.HIVE is defined and cluster_services.RANGER is defined and cluster_services.RANGER.PLUGIN.HIVE %}true{% else %}false{% endif %}",
        "hive.security.authorization.manager" : "org.apache.hadoop.hive.ql.security.authorization.plugin.sqlstd.SQLStdConfOnlyAuthorizerFactory",
        "hive.security.metastore.authenticator.manager" : "org.apache.hadoop.hive.ql.security.HadoopDefaultMetastoreAuthenticator",
        "hive.security.metastore.authorization.auth.reads" : "true",
        "hive.security.metastore.authorization.manager" : "org.apache.hadoop.hive.ql.security.authorization.StorageBasedAuthorizationProvider",
        "hive.server2.allow.user.substitution" : "true",
        "hive.server2.authentication" : "NONE",
        "hive.server2.authentication.kerberos.keytab" : "/etc/security/keytabs/hive.service.keytab",
        "hive.server2.authentication.kerberos.principal" : "hive/_HOST@EXAMPLE.COM",
        "hive.server2.authentication.ldap.url" : " ",
        "hive.server2.authentication.spnego.keytab" : "HTTP/_HOST@EXAMPLE.COM",
        "hive.server2.authentication.spnego.principal" : "/etc/security/keytabs/spnego.service.keytab",
        "hive.server2.enable.doAs" : "{%if cluster_services.RANGER is defined and cluster_services.RANGER.PLUGIN.HIVE is defined and cluster_services.RANGER is defined and cluster_services.RANGER.PLUGIN.HIVE %}false{% else %}true{% endif %}",
        "hive.server2.logging.operation.enabled" : "true",
        "hive.server2.logging.operation.log.location" : "/tmp/hive/operation_logs",
        "hive.server2.max.start.attempts" : "5",
        "hive.server2.support.dynamic.service.discovery" : "true",
        "hive.server2.table.type.mapping" : "CLASSIC",
        "hive.server2.tez.default.queues" : "default",
        "hive.server2.tez.initialize.default.sessions" : "false",
        "hive.server2.tez.sessions.per.default.queue" : "1",
        "hive.server2.thrift.http.path" : "cliservice",
        "hive.server2.thrift.http.port" : "10001",
        "hive.server2.thrift.max.worker.threads" : "500",
        "hive.server2.thrift.port" : "10000",
        "hive.server2.thrift.sasl.qop" : "auth",
				{% if cluster_services.HIVE.SSL is defined and cluster_services.HIVE.SSL %}
				"hive.server2.use.SSL" : "true",
				"hive.server2.keystore.path": "{{ssl_keystore_path}}",
				"hive.server2.keystore.password": "{{ssl_keystore_password}}",
				"hive.server2.transport.mode" : "http",
				{% else %}
				"hive.server2.use.SSL" : "false",
				"hive.server2.transport.mode" : "binary",
				{% endif %}
        "hive.server2.zookeeper.namespace" : "hiveserver2",
        "hive.smbjoin.cache.rows" : "10000",
        "hive.stats.autogather" : "true",
        "hive.stats.dbclass" : "fs",
        "hive.stats.fetch.column.stats" : "false",
        "hive.stats.fetch.partition.stats" : "true",
        "hive.support.concurrency" : "false",
        "hive.tez.auto.reducer.parallelism" : "false",
        "hive.tez.container.size" : "1024",
        "hive.tez.cpu.vcores" : "-1",
        "hive.tez.dynamic.partition.pruning" : "true",
        "hive.tez.dynamic.partition.pruning.max.data.size" : "104857600",
        "hive.tez.dynamic.partition.pruning.max.event.size" : "1048576",
        "hive.tez.input.format" : "org.apache.hadoop.hive.ql.io.HiveInputFormat",
        "hive.tez.java.opts" : "-server -Xmx545m -Djava.net.preferIPv4Stack=true -XX:NewRatio=8 -XX:+UseNUMA -XX:+UseParallelGC -XX:+PrintGCDetails -verbose:gc -XX:+PrintGCTimeStamps",
        "hive.tez.log.level" : "INFO",
        "hive.tez.max.partition.factor" : "2.0",
        "hive.tez.min.partition.factor" : "0.25",
        "hive.tez.smb.number.waves" : "0.5",
        "hive.txn.manager" : "org.apache.hadoop.hive.ql.lockmgr.DummyTxnManager",
        "hive.txn.max.open.batch" : "1000",
        "hive.txn.timeout" : "300",
        "hive.user.install.directory" : "/user/",
        "hive.vectorized.execution.enabled" : "true",
        "hive.vectorized.execution.reduce.enabled" : "false",
        "hive.vectorized.groupby.checkinterval" : "4096",
        "hive.vectorized.groupby.flush.percent" : "0.1",
        "hive.vectorized.groupby.maxentries" : "100000",
        "hive.zookeeper.client.port" : "2181",
        "hive.zookeeper.namespace" : "hive_zookeeper_namespace",
        "hive.zookeeper.quorum" : "{% for host in zookeeper_quorum %}{{ host }}:2181{% if not loop.last %},{% endif %}{% endfor %}"
			}
		}
	}
}
